
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 98%; /* Light mode background */
    --foreground: 240 10% 3.9%; /* Light mode text */
    --card: 0 0% 100%; /* Light mode card background */
    --card-foreground: 240 10% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 240 10% 3.9%;
    --primary: 258 84% 58%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 95%; /* Light mode secondary */
    --secondary-foreground: 240 10% 3.9%;
    --muted: 0 0% 95%; /* Light mode muted */
    --muted-foreground: 0 0% 45%;
    --accent: 0 0% 95%; /* Light mode accent */
    --accent-foreground: 240 10% 3.9%;
    --destructive: 0 89% 48%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89%; /* Light mode border */
    --input: 0 0% 89%; /* Light mode input */
    --ring: 258 84% 58%; /* Ring to match primary accent */
    --radius: 1rem;
    --chart-1: 258 84% 58%;
    --chart-2: 256 90% 66%;
    --chart-3: 151 96% 46%;
    --chart-4: 250 95% 85%;
    --chart-5: 252 91% 95%;
    --chart-orange: 30 90% 50%;
    
    --sidebar-background: 0 0% 96%; /* Light mode sidebar */
    --sidebar-foreground: 240 10% 3.9%;
    --sidebar-primary: 0 0% 95%;
    --sidebar-primary-foreground: 240 10% 3.9%;
    --sidebar-accent: 0 0% 90%;
    --sidebar-accent-foreground: 240 10% 3.9%;
    --sidebar-border: 0 0% 100% / 0.10;
    --sidebar-ring: 0 0% 100% / 0.12;

    --surface-card: #ffffff;
    --card-border-subtle: rgba(0,0,0,.10);

    /* Palette and KPI */
    --palette-1: #98CEF3;
    --palette-2: #B9E0FF;
    --palette-3: #D0E6FB;
    --palette-4: #E6D6FD;
    --palette-5: #E4C5FB;
    --palette-6: #D2ACFB;
    --kpi-color: var(--palette-1);

    /* Nav dividers */
    --nav-divider: rgba(2, 6, 23, .10);
    --nav-border:  rgba(2, 6, 23, .12);
  }

  .dark {
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;
    --card: 240 4% 5%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 258 84% 58%; /* Soft purple glow */
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 10%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 7%;
    --muted-foreground: 0 0% 70%;
    --accent: 258 84% 58% / 0.1; /* Soft purple glow at 10% opacity */
    --accent-foreground: 0 0% 98%;
    --destructive: 0 89% 48%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 100% / 0.10;
    --input: 0 0% 14%;
    --ring: 258 84% 58%; /* Ring to match primary accent */
    --radius: 1rem;
    --chart-1: 258 84% 58%;
    --chart-2: 256 90% 66%;
    --chart-3: 151 96% 46%;
    --chart-4: 250 95% 85%;
    --chart-5: 252 91% 95%;
    --chart-orange: 30 90% 50%;
    --sidebar-background: 0 0% 6%;
    --sidebar-foreground: 0 0% 98%;
    --sidebar-primary: 0 0% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 0 0% 10%;
    --sidebar-accent-foreground: 0 0% 98%;
    --sidebar-border: 0 0% 100% / 0.10;
    --sidebar-ring: 0 0% 100% / 0.12;
    --surface-card: #0c0c0c;
    --card-border-subtle: rgba(255,255,255,.10);

    /* Nav dividers */
    --nav-divider: rgba(255,255,255, .10);
    --nav-border:  rgba(255,255,255, .12);
  }
}

@layer base {
  html, body, #__next {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
  
  html {
    height: 100%;
  }
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    min-height: 100vh;
    height: 100%;
    background-attachment: fixed;
    font-family: var(--font-inter);
    transition: background-color 0.3s ease, color 0.3s ease;
  }
}

@layer components {
  /* === GLOBAL CARD SHAPE RESET ============================================= */
  /* Single place to control card corner */
  :root { --card-radius: var(--radius); } /* you already define --radius */

  /* A “universal card selector” — everything that visually looks like a card   */
  /* Uses :where() to keep specificity *very* low, so it wins without !important */
  :where(
    /* our own */
    .bg-card, .surface-card, [data-card="true"], .panel, .card, .shadcn-card,
    /* common lib cards */
    .ant-card, .ant-card-bordered,                       /* Ant Design */
    .MuiCard-root, .MuiPaper-root.MuiCard-root,          /* MUI */
    .chakra-card,                                        /* Chakra */
    .mantine-Card-root,                                  /* Mantine */
    /* our dashboard/layout “panel” wrappers if any */
    section[data-surface="card"], article[data-surface="card"]
  ) {
    border-radius: var(--card-radius);
    /* clip contents so charts/tables respect corners */
    overflow: hidden; /* fallback for older browsers */
    overflow: clip;   /* modern, avoids creating stacking context */
    background-clip: padding-box; /* cleaner antialiasing on masks */
  }

  /* If a component tries to flatten corners, put them back */
  :where(
    .bg-card, .surface-card, [data-card="true"], .panel, .card, .shadcn-card,
    .ant-card, .MuiCard-root, .chakra-card, .mantine-Card-root
  ).rounded-none { border-radius: var(--card-radius); }

  /* Any card whose shape is applied to a *child* wrapper (e.g., table/charts) */
  :where(.bg-card, .surface-card, .card, .ant-card, .MuiCard-root) > :where(
    .card-header, .card-content, .card-footer, .ant-card-body,
    .MuiCardContent-root, .MuiCardHeader-root
  ) {
    border-radius: inherit;
  }

  /* Prevent inner “modules” from disabling clipping */
  :where(.bg-card, .surface-card, .card, .ant-card, .MuiCard-root) > :where(*) {
    /* only adjust if libraries set overflow-visible */
    overflow: initial;
  }

  /* Charts & canvases: ensure they obey card radius when placed directly inside */
  :where(.bg-card, .surface-card, .card, .ant-card, .MuiCard-root)
    :where(.recharts-wrapper, canvas, svg, .echarts-for-react) {
    border-radius: inherit;
    overflow: hidden;
    background-clip: padding-box;
  }

  /* Table cards: outer card clips; tables themselves keep square rows */
  :where(.bg-card, .surface-card, .card, .ant-card, .MuiCard-root) table {
    border-radius: 0;
  }

  /* Grid-list dashboards often render “square by default”. Catch those items. */
  .grid > :where(.bg-card, .surface-card, .panel, .card, .ant-card, .MuiCard-root),
  .grid [data-card="true"] {
    border-radius: var(--card-radius);
    overflow: hidden;
  }
}


@layer utilities {
  .neon-glow {
    box-shadow: 0 0 60px 20px rgba(157, 78, 221, 0.65), 0 0 120px 40px rgba(80, 0, 255, 0.15);
  }

  .kpi-value {
    color: var(--kpi-color) !important;
  }
  
  .due-box {
    @apply inline-block px-2 py-0.5 rounded text-xs font-semibold;
  }

  .due-pulse {
      animation: pulse 1.5s infinite ease-in-out;
  }

  @keyframes pulse {
    0%, 100% {
      transform: scale(1);
      box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
    }
    50% {
      transform: scale(1.02);
      box-shadow: 0 0 5px 3px rgba(239, 68, 68, 0);
    }
  }

  /* Tag styles for contacts page */
  .tag-client { @apply bg-blue-500/20 text-blue-300 border-blue-500/50 text-xs px-2 py-0.5 rounded-full border; }
  .tag-prospect { @apply bg-purple-500/20 text-purple-300 border-purple-500/50 text-xs px-2 py-0.5 rounded-full border; }
  .tag-lead { @apply bg-yellow-500/20 text-yellow-300 border-yellow-500/50 text-xs px-2 py-0.5 rounded-full border; }
  .tag-referred { @apply bg-green-500/20 text-green-300 border-green-500/50 text-xs px-2 py-0.5 rounded-full border; }
  .tag-vip { @apply bg-pink-500/20 text-pink-300 border-pink-500/50 text-xs px-2 py-0.5 rounded-full border; }
  .tag-new { @apply bg-cyan-500/20 text-cyan-300 border-cyan-500/50 text-xs px-2 py-0.5 rounded-full border; }
  .tag-default { @apply bg-gray-500/20 text-gray-300 border-gray-500/50 text-xs px-2 py-0.5 rounded-full border; }

  /* Glow animations for compliance badges */
  @keyframes glow-trading {
    0%, 100% { box-shadow: 0 0 2px 0px #ef4444; }
    50% { box-shadow: 0 0 6px 2px #ef4444; }
  }
  @keyframes glow-anomaly {
    0%, 100% { box-shadow: 0 0 2px 0px #A259F7; }
    50% { box-shadow: 0 0 6px 2px #A259F7; }
  }
  @keyframes glow-activity {
    0%, 100% { box-shadow: 0 0 2px 0px #22c55e; }
    50% { box-shadow: 0 0 6px 2px #22c55e; }
  }
  .animate-glow-trading { animation: glow-trading 2s ease-in-out infinite; }
  .animate-glow-anomaly { animation: glow-anomaly 2.5s ease-in-out infinite; }
  .animate-glow-activity { animation: glow-activity 3s ease-in-out infinite; }

  .shadow-white-glow-soft { box-shadow: 0 1px 3px 0 rgba(255, 255, 255, 0.03); }
  .hover\:shadow-white-glow-hover:hover { box-shadow: 0 2px 8px 0 rgba(255, 255, 255, 0.06); }
  .details-no-marker::marker { display: none; content: ""; }
  .details-no-marker summary::-webkit-details-marker { display: none; }
  .no-scrollbar::-webkit-scrollbar { display: none; }
  .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
}

/* Recharts (SVG) axis/label default textcolor stays neutral */
.recharts-text, .recharts-cartesian-axis-tick-value {
  fill: rgba(255,255,255,0.75);
}

.dark .recharts-text, .dark .recharts-cartesian-axis-tick-value {
  fill: rgba(255,255,255,0.75);
}
:root .recharts-text, :root .recharts-cartesian-axis-tick-value {
  fill: rgba(0,0,0,0.75);
}

/* ---------------------------------------------------------- */
/*  Topbar separator: match the faint divider used projectwide */
/* ---------------------------------------------------------- */
:root { --topbar-sep: rgba(2, 6, 23, .08); }                 /* light */
.dark { --topbar-sep: rgba(255,255,255,.08); }  /* dark = faint white */

/* Normalize ALL header variants to the same faint separator */
.topbar, header[role="banner"], .app-header, .site-header, .navbar, [data-topbar],
.sticky.top-0, .fixed.top-0 {
  border-bottom: 0 !important;
  box-shadow: none !important;
  outline: none !important;
  box-shadow: inset 0 -1px 0 var(--topbar-sep) !important;
  background: hsl(var(--background)) !important;
  color: hsl(var(--foreground)) !important;
}

.topbar::after, header[role="banner"]::after, .navbar::after, [data-topbar]::after {
  content: none !important;
}
.topbar.border, header[role="banner"].border, .navbar.border, [data-topbar].border {
  border-bottom: 1px solid var(--topbar-sep) !important;
}

/* -------------------- SIDEBAR (light + dark) -------------------- */
.sidebar {
  background: hsl(var(--background)) !important;
  color: hsl(var(--foreground)) !important;
  border-right: 1px solid var(--nav-border) !important;
  box-shadow: none !important;
  outline: none !important;
}
.dark .sidebar {
  background: #0b0b0b !important;
  color: rgba(255, 255, 255, 0.75) !important;
  border-right: 1px solid var(--nav-border) !important;
}
.sidebar hr,
.sidebar .divider,
.sidebar .divide-y > :not([hidden]) ~ :not([hidden]) {
  border: 0;
  border-top: 1px solid var(--nav-divider) !important;
  opacity: 1;
}

hr {
  border: 0;
  border-top: 1px solid var(--nav-divider) !important;
}

.dark .report-card,
[data-theme="dark"] .report-card {
  background-color: var(--surface-card) !important;
  border-color: var(--card-border-subtle) !important;
}

/* -------------------- SIDEBAR HOVER / ACTIVE (fix purple) -------------------- */
:root {
  --sidebar-hover-light: rgba(2, 6, 23, .04);
  --sidebar-active-light: rgba(2, 6, 23, .06);
}
.dark {
  --sidebar-hover: rgba(255,255,255,.04);
  --sidebar-active: rgba(255,255,255,.08);
}

.dark .sidebar a,
.dark .sidebar button,
.dark .sidebar [role="menuitem"] {
  background: transparent;
  background-image: none !important;
  color: rgba(255,255,255,.72);
  transition: background-color .12s ease, color .12s ease;
}

.dark .sidebar a:hover,
.dark .sidebar button:hover,
.dark .sidebar [role="menuitem"]:hover,
.dark .sidebar .group:hover,
.dark .sidebar [data-hover="true"] {
  background: var(--sidebar-hover) !important;
  color: rgba(255,255,255,.92) !important;
  background-image: none !important;
}

.dark .sidebar .active,
.dark .sidebar a[aria-current="page"],
.dark .sidebar [data-selected="true"],
.dark .sidebar [data-state="open"],
.dark .sidebar .group[data-state="open"],
.dark .sidebar .group[aria-expanded="true"] {
  background: var(--sidebar-active) !important;
  color: rgba(255,255,255,.96) !important;
  background-image: none !important;
}

.dark .sidebar [class*="bg-primary"],
.dark .sidebar [class*="bg-accent"],
.dark .sidebar [class*="bg-violet"],
.dark .sidebar [class*="bg-purple"] {
  background: var(--sidebar-active) !important;
  background-image: none !important;
}

:root .sidebar a:hover,
:root .sidebar button:hover,
:root .sidebar [role="menuitem"]:hover {
  background: var(--sidebar-hover-light) !important;
}

:root .sidebar .active,
:root .sidebar a[aria-current="page"],
:root .sidebar [data-selected="true"],
:root .sidebar [data-state="open"] {
  background: var(--sidebar-active-light) !important;
}
